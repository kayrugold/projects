<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Composite Gap Scanner v2.1</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
    body { background-color: #0f172a; color: #e2e8f0; font-family: monospace; padding: 20px; }
    
    .scanner-box { 
        background: #1e293b; border: 1px solid #334155; border-radius: 12px; 
        padding: 20px; display: flex; flex-direction: column; gap: 20px;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
        max-width: 600px; margin: 0 auto;
    }

    .input-group { display: flex; gap: 10px; }
    
    input { 
        background: #020617; border: 1px solid #475569; color: white; 
        padding: 12px 16px; border-radius: 6px; font-size: 1.2rem; width: 100%; 
        font-family: monospace; font-weight: bold;
    }
    
    button { 
        background: #3b82f6; color: white; border: none; padding: 0 20px; 
        border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 1rem;
        transition: background 0.2s; white-space: nowrap;
    }
    button:hover { background: #2563eb; }

    /* --- UI FIX: SCROLL CONTAINER --- */
    .gap-strip-container {
        width: 100%;
        overflow-x: auto;
        /* Padding ensures shadows/borders aren't cut off */
        padding: 20px 0; 
        /* Smooth scrolling on mobile */
        -webkit-overflow-scrolling: touch; 
    }

    .gap-strip {
        display: flex; 
        gap: 12px; 
        /* Fix: Use flex-start so content grows to the right and is scrollable */
        justify-content: flex-start; 
        /* Fix: Add margin auto to center when content is small, but allow scroll when large */
        min-width: min-content; 
        margin: 0 auto;
        padding: 0 20px; /* Horizontal padding inside the scroll area */
    }

    .num-block {
        flex-shrink: 0; /* Fix: Prevent blocks from squishing */
        padding: 16px; border-radius: 8px; font-weight: bold; 
        border: 1px solid transparent; min-width: 90px; text-align: center;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        transition: transform 0.2s; position: relative;
    }
    .num-block:hover { transform: translateY(-4px); z-index: 10; }

    /* COLORS */
    .type-comp { 
        background: #450a0a; color: #fca5a5; border-color: #7f1d1d; 
        box-shadow: 0 4px 0 #7f1d1d;
    }
    .type-prime { 
        background: #064e3b; color: #34d399; border-color: #059669; 
        box-shadow: 0 4px 0 #059669;
    } 
    .type-target { 
        border: 2px solid #fbbf24; z-index: 20; 
        box-shadow: 0 0 25px rgba(251, 191, 36, 0.25), 0 4px 0 #b45309; 
        transform: scale(1.05);
    }

    .main-num { font-size: 1.6rem; line-height: 1; margin-bottom: 4px; }
    .sub-label { font-size: 0.7rem; opacity: 0.8; letter-spacing: 1px; text-transform: uppercase; }
    
    /* THE PICKUP EQUATION */
    .pickup-eq {
        background: rgba(0,0,0,0.4);
        padding: 4px 8px;
        border-radius: 4px;
        margin-top: 8px;
        font-size: 0.8rem;
        color: #fff;
        font-family: 'Courier New', monospace;
        white-space: nowrap;
        border: 1px solid rgba(255,255,255,0.1);
    }
    .engine-id { color: #fbbf24; font-weight: bold; } /* Highlights the Engine (3, 5, etc) */

    /* STATS GRID */
    .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
    .stat-card {
        background: #0f172a; border: 1px solid #334155; padding: 12px; 
        border-radius: 6px; text-align: center;
    }
    .stat-lbl { font-size: 0.65rem; color: #94a3b8; text-transform: uppercase; margin-bottom: 4px; }
    .stat-val { font-size: 1.1rem; font-weight: bold; color: #e2e8f0; }

</style>
</head>
<body>

<div class="scanner-box">
    <div>
        <label class="text-xs text-blue-400 font-bold uppercase tracking-wider mb-2 block">Center Odd Number</label>
        <div class="input-group">
            <input type="number" id="inpNum" value="101" step="2">
            <button onclick="scanGap()">SCAN GAP</button>
        </div>
    </div>

    <div>
        <div class="gap-strip-container" id="scrollWrapper">
            <div id="gapContainer" class="gap-strip">
                <span class="text-slate-500 italic self-center">Ready to scan...</span>
            </div>
        </div>
        <div class="text-center text-xs text-slate-500 mt-2">Scroll horizontally to view full gap</div>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-lbl">Lower Wall</div>
            <div id="txtLow" class="stat-val text-red-300">--</div>
        </div>
        <div class="stat-card">
            <div class="stat-lbl text-blue-300">Gap Size</div>
            <div id="txtGap" class="stat-val text-blue-300">--</div>
        </div>
        <div class="stat-card">
            <div class="stat-lbl">Upper Wall</div>
            <div id="txtHigh" class="stat-val text-red-300">--</div>
        </div>
    </div>
</div>

<script>
// --- LOGIC: The "Source Detective" ---

function identifySource(n) {
    // 1. Trap 1: The 3-Engine (The 3-Progression)
    if (n % 3n === 0n) return { engine: 3, factor: n/3n };

    // 2. Trap 2: The 5-Engine (The 5-Progression)
    if (n % 5n === 0n) return { engine: 5, factor: n/5n };

    // 3. Trap 3: Brute Force Scan for other Progressions
    let limit = n; 
    for (let i = 7n; i * i <= n; i += 2n) {
        if (n % i === 0n) return { engine: i, factor: n/i };
        if (i > 1000n) break; // Safety break for UI
    }
    
    return null; // Prime or Unknown Source (Large Factor)
}

function isComposite(n) {
    if (n <= 3n) return false;
    if (n % 2n === 0n) return true;
    if (identifySource(n) !== null) return true;
    return false; // Assuming prime for this visualization scale
}


// --- APP LOGIC ---

function scanGap() {
    const raw = document.getElementById('inpNum').value;
    let center;
    try { center = BigInt(raw); } catch(e) { return; }
    
    if (center % 2n === 0n) center += 1n; // Force Odd
    document.getElementById('inpNum').value = center.toString();
    
    // 1. Find Lower Wall
    let low = center - 2n;
    while (!isComposite(low) && low > 1n) {
        low -= 2n;
    }
    if (low < 1n) low = 1n; 

    // 2. Find Upper Wall
    let high = center + 2n;
    while (!isComposite(high)) {
        high += 2n;
    }

    // 3. Render
    renderStrip(low, high, center);
    
    // 4. Update Stats
    document.getElementById('txtLow').innerText = low.toString();
    document.getElementById('txtHigh').innerText = high.toString();
    document.getElementById('txtGap').innerText = (high - low).toString();
}

function renderStrip(low, high, target) {
    const container = document.getElementById('gapContainer');
    container.innerHTML = '';

    // Loop from Low Wall to High Wall
    // (We render the whole gap to ensure we see the "Gap Foundation")
    let current = low;
    let count = 0;
    
    while (current <= high) {
        const div = document.createElement('div');
        const isComp = (current === low || current === high);
        const isTgt = (current === target);
        
        div.className = `num-block ${isComp ? 'type-comp' : 'type-prime'} ${isTgt ? 'type-target' : ''}`;
        
        // 1. Number
        const numSpan = document.createElement('div');
        numSpan.className = 'main-num';
        numSpan.innerText = current.toString();
        div.appendChild(numSpan);
        
        // 2. Label
        const label = document.createElement('div');
        label.className = "sub-label";
        
        if (isComp) {
            label.innerText = "WALL";
            div.appendChild(label);
            
            // 3. THE PICKUP (Arithmetic Progression Source)
            const src = identifySource(current);
            if (src) {
                const eqDiv = document.createElement('div');
                eqDiv.className = 'pickup-eq';
                // Showing: Engine × Factor
                // This proves the arithmetic progression
                eqDiv.innerHTML = `<span class="engine-id">${src.engine}</span> × ${src.factor}`;
                div.appendChild(eqDiv);
            }
        } else {
            label.innerText = "GAP";
            div.appendChild(label);
        }
        
        container.appendChild(div);
        
        // Scroll Logic: Center the target
        if (isTgt) {
            setTimeout(() => {
                div.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }, 100);
        }

        current += 2n;
        count++;
        // If the gap is huge, break to save memory, but show indicator
        if (count > 100) {
            const span = document.createElement('div');
            span.innerText = "...";
            span.style.color = "#64748b";
            span.style.alignSelf = "center";
            container.appendChild(span);
            break;
        }
    }
}

// Init
scanGap();

</script>
</body>
</html>
