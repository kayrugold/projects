<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Gatekeeper: Instant Composite Check</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
    body { background: #0f172a; color: #fff; font-family: monospace; padding: 20px; }
    .card { background: #1e293b; padding: 20px; border-radius: 8px; max-width: 600px; margin: 0 auto; }
    .input { background: #334155; border: 1px solid #475569; color: white; padding: 5px; width: 100%; margin-bottom: 10px; }
    .btn { background: #6366f1; padding: 10px; width: 100%; font-weight: bold; cursor: pointer; }
    #result { margin-top: 20px; font-size: 1.2rem; font-weight: bold; text-align: center; }
</style>
</head>
<body>
<div class="card">
    <h1 class="text-xl text-center mb-4">THE GATEKEEPER</h1>
    <label>Target Number (N)</label>
    <textarea id="input-n" class="input" rows="4">1522605027922533360535618378132637429718068114961380688657908494580122963258952897654000350692006139</textarea>
    <button class="btn" onclick="check()">INTERROGATE WITNESS</button>
    <div id="result"></div>
</div>

<script>
// Standard Modular Exponentiation (Your 'powMod')
function powMod(b, e, m) {
    let r = 1n; b %= m;
    while (e > 0n) {
        if (e & 1n) r = (r * b) % m;
        e >>= 1n;
        b = (b * b) % m;
    }
    return r;
}

function check() {
    try {
        const N_str = document.getElementById('input-n').value.replace(/\s/g,'');
        const N = BigInt(N_str);
        
        // 1. The Witness
        // We use the base '2'. If N is prime, 2^(N-1) % N must be 1.
        const witness = 2n;
        
        document.getElementById('result').innerText = "Calculating Shadow...";
        
        setTimeout(() => {
            const start = performance.now();
            
            // THE TEST
            const shadow = powMod(witness, N - 1n, N);
            const time = (performance.now() - start).toFixed(2);

            if (shadow === 1n) {
                document.getElementById('result').innerHTML = 
                    `<span class="text-yellow-400">PROBABLY PRIME</span><br><span class="text-xs text-gray-400">Shadow is 1. Passed Fermat Test.</span>`;
            } else {
                document.getElementById('result').innerHTML = 
                    `<span class="text-red-500">DEFINITELY COMPOSITE</span><br><span class="text-xs text-gray-400">Shadow is ${shadow.toString().substring(0,10)}...</span><br><span class="text-xs text-gray-500">Time: ${time}ms</span>`;
            }
        }, 50);
        
    } catch (e) {
        document.getElementById('result').innerText = "Error: Invalid Number";
    }
}
</script>
</body>
</html>

