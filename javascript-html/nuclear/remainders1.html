<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Factor Hunter: Staircase Gnomon</title>
    <style>
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        h1 { color: #00e676; margin-bottom: 10px; text-align: center; }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: #1e1e1e;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid #333;
        }

        input {
            padding: 10px;
            background: #333;
            border: 1px solid #555;
            color: white;
            border-radius: 8px;
            width: 80px;
            font-size: 1.2rem;
            text-align: center;
        }

        button {
            padding: 10px 20px;
            background: #00e676;
            color: #000;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1rem;
        }

        #canvas-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
            overflow: auto;
            max-width: 100%;
        }

        canvas {
            border: 1px solid #333;
            background: #181818;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        .info {
            margin-top: 15px;
            color: #888;
            text-align: center;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .highlight { color: #00e676; font-weight: bold; }
    </style>
</head>
<body>

    <h1>Staircase Gnomon</h1>

    <div class="controls">
        <button onclick="prev()">-</button>
        <input type="number" id="numInput" value="11" inputmode="numeric">
        <button onclick="next()">+</button>
        <button onclick="drawGnomon()">VIEW</button>
    </div>

    <div id="canvas-container">
        <canvas id="mainCanvas"></canvas>
    </div>

    <div class="info" id="infoText"></div>

    <script>
        const canvas = document.getElementById('mainCanvas');
        const ctx = canvas.getContext('2d');
        const input = document.getElementById('numInput');
        const info = document.getElementById('infoText');

        function next() { input.value = parseInt(input.value) + 1; drawGnomon(); }
        function prev() { input.value = Math.max(1, parseInt(input.value) - 1); drawGnomon(); }

        function drawGnomon() {
            const n = parseInt(input.value);
            if (!n || n < 1) return;

            // For this specific "Staircase" shape to be symmetrical like a standard gnomon,
            // it should ideally be an ODD number.
            // The shape consists of:
            // 1. A bottom row of length L.
            // 2. A diagonal staircase of height H starting from the corner.
            // The corner block is shared.
            // Total N = L + (H - 1).
            // For a symmetric-ish look (like your drawing for 11), let's try to keep L and H similar.
            // Let's use the same "difference of squares" logic to determine dimensions, but draw it differently.
            
            const isOdd = (n % 2 !== 0);
            let armLength = 0;

            if (isOdd) {
                // n = 2x + 1.  The "arms" of the L are length (n+1)/2.
                armLength = (n + 1) / 2;
            } else {
                // For evens, let's just make a shape that fits.
                // Bottom will be n/2, diagonal will be n/2 + 1? No that's n+1.
                // Let's just make the bottom arm longer.
                armLength = Math.floor(n / 2) + 1; // e.g. for 10, arm is 6.
            }

            const bottomLen = armLength;
            // The diagonal height is the remaining blocks + the corner block.
            const diagHeight = (n - bottomLen) + 1;

            // 2. Setup Canvas
            const blockSize = 30;
            const gap = 2;
            const padding = 40;
            
            // Canvas size needs to fit the width and the height of the staircase.
            // Width is determined by the bottom bar.
            // Height is determined by the diagonal.
            const gridW = bottomLen;
            const gridH = diagHeight;
            
            const totalWidthPx = (gridW * (blockSize + gap)) + (padding * 2);
            const totalHeightPx = (gridH * (blockSize + gap)) + (padding * 2);
            
            const dpr = window.devicePixelRatio || 1;
            canvas.style.width = totalWidthPx + 'px';
            canvas.style.height = totalHeightPx + 'px';
            canvas.width = totalWidthPx * dpr;
            canvas.height = totalHeightPx * dpr;
            ctx.scale(dpr, dpr);

            ctx.clearRect(0, 0, totalWidthPx, totalHeightPx);

            // Draw grid lines for context (optional, but helps see the staircase)
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 1;
            ctx.beginPath();
            for(let i=0; i<=gridW; i++) {
                const x = padding + i*(blockSize+gap) - gap/2;
                ctx.moveTo(x, padding); ctx.lineTo(x, totalHeightPx-padding);
            }
            for(let i=0; i<=gridH; i++) {
                const y = padding + i*(blockSize+gap) - gap/2;
                ctx.moveTo(padding, y); ctx.lineTo(totalWidthPx-padding, y);
            }
            ctx.stroke();


            info.innerHTML = `
                Displaying <span class="highlight">${n}</span> as a Staircase Gnomon.<br>
                Bottom Base: ${bottomLen} blocks | Diagonal Stair: ${diagHeight} blocks (Corner is shared)
            `;

            // Draw Logic based on your image
            ctx.fillStyle = '#00e676'; // Bright green

            // 1. Draw Bottom Row
            // It is at the bottom-most grid row index: gridH - 1
            const startX = padding;
            const startY = padding;
            const bottomRowY = startY + (gridH - 1) * (blockSize + gap);

            for (let c = 0; c < bottomLen; c++) {
                ctx.fillRect(
                    startX + c * (blockSize + gap), 
                    bottomRowY,
                    blockSize, blockSize
                );
            }
            
            // 2. Draw Diagonal Staircase
            // Starts from the corner (which is already drawn) and goes up and left.
            // Corner is at col index (bottomLen - 1) and row index (gridH - 1).
            // We need to draw (diagHeight - 1) more blocks.
            
            let stairC = bottomLen - 1; // Start at corner column
            let stairR = gridH - 1;     // Start at corner row
            
            // We already drew the corner. Move one step up and left.
            stairC--;
            stairR--;
            
            for (let i = 0; i < diagHeight - 1; i++) {
                if (stairC < 0 || stairR < 0) break; // Safety

                ctx.fillRect(
                    startX + stairC * (blockSize + gap), 
                    startY + stairR * (blockSize + gap),
                    blockSize, blockSize
                );
                
                // Move up and left for next block
                stairC--;
                stairR--;
            }
        }

        // Init
        drawGnomon();

        input.addEventListener("keypress", function(event) {
            if (event.key === "Enter") drawGnomon();
        });

    </script>
</body>
</html>
