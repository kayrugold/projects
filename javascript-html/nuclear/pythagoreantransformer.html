<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pythagorean Transformer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background-color: #0f172a; color: white; font-family: 'Courier New', monospace; }
        .cell { transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        
        /* Animations for the "Unwrap" effect */
        .detach { transform: translate(20px, -20px) scale(0.9); box-shadow: 0 0 15px rgba(234, 179, 8, 0.5); z-index: 50; }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">

const App = () => {
    // The "Special" Layers where Rim is a Square
    // k is the odd number root of the rim.
    // Layer Index L = (k^2 + 1) / 2
    // k=3 -> L=5 (Rim 9)
    // k=5 -> L=13 (Rim 25)
    // k=7 -> L=25 (Rim 49)
    
    const triples = [
        { k: 3, layer: 5, inner: 4, outer: 5, rim: 9 },   // 3-4-5
        { k: 5, layer: 13, inner: 12, outer: 13, rim: 25 }, // 5-12-13
        { k: 7, layer: 25, inner: 24, outer: 25, rim: 49 }  // 7-24-25
    ];

    const [index, setIndex] = React.useState(0);
    const [isDetached, setIsDetached] = React.useState(false);

    const current = triples[index];
    const gridSize = current.outer; // 5, 13, or 25

    // Safe render limit logic
    // Rendering 25x25 is fine, but let's keep cells small for larger grids
    const cellSize = gridSize > 15 ? "w-3 h-3 text-[0px]" : "w-8 h-8 text-xs";

    const renderGrid = () => {
        let grid = [];
        for (let y = 0; y < gridSize; y++) {
            let row = [];
            for (let x = 0; x < gridSize; x++) {
                
                const isRim = (x === gridSize - 1) || (y === gridSize - 1);
                
                // Styling
                let baseClass = `cell border border-slate-800 flex items-center justify-center ${cellSize}`;
                let style = {};
                
                if (isRim) {
                    // The Rim (Yellow)
                    // If detached, we technically want to show it moving away?
                    // For simplicity in this grid view, we just highlight it.
                    // To strictly visualize "Reshaping", we need a separate container for the rim blocks.
                    
                    if (isDetached) {
                        // Hide the rim in the main grid
                        baseClass += " opacity-0";
                    } else {
                        baseClass += " bg-yellow-500 text-black font-bold border-yellow-600";
                    }
                    
                } else {
                    // The Inner Square (Blue)
                    baseClass += " bg-blue-600 text-blue-200";
                }

                row.push(<div key={`${x}-${y}`} className={baseClass} style={style}></div>);
            }
            grid.push(<div key={y} className="flex">{row}</div>);
        }
        return grid;
    };

    // Render the "Reshaped" Rim Square
    const renderRimSquare = () => {
        if (!isDetached) return null;

        const side = current.k; // e.g., 3 or 5
        let grid = [];
        
        for (let y = 0; y < side; y++) {
            let row = [];
            for (let x = 0; x < side; x++) {
                row.push(
                    <div key={`rim-${x}-${y}`} className={`cell border border-yellow-600 bg-yellow-500 ${cellSize}`}></div>
                );
            }
            grid.push(<div key={y} className="flex">{row}</div>);
        }
        
        return (
            <div className="flex flex-col animate-[fadeIn_0.5s_ease-out]">
                {grid}
                <div className="text-center text-yellow-400 font-bold mt-2 text-xs">
                    {current.k} x {current.k} = {current.rim}
                </div>
            </div>
        );
    };

    return (
        <div className="min-h-screen bg-slate-950 p-6 flex flex-col items-center justify-center">
            
            <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-white mb-2">PYTHAGOREAN <span className="text-yellow-500">LAYERS</span></h1>
                <p className="text-xs text-slate-400 uppercase tracking-widest">When the Strip becomes a Square</p>
            </div>

            <div className="flex flex-col md:flex-row items-center justify-center gap-12 w-full max-w-5xl">
                
                {/* MAIN GRID */}
                <div className="flex flex-col items-center">
                    <div className="text-blue-400 font-bold mb-2 text-sm">Inner Square ({current.inner}²)</div>
                    <div className="bg-slate-900 p-2 rounded border border-slate-800 shadow-2xl relative">
                        <div className="flex flex-col">
                            {renderGrid()}
                        </div>
                        
                        {/* Overlay Label for Inner */}
                        <div className="absolute inset-0 flex items-center justify-center pointer-events-none">
                            {!isDetached && <div className="text-white/20 font-bold text-4xl">{current.outer}²</div>}
                        </div>
                    </div>
                </div>

                {/* ACTION ARROW */}
                <div className="flex flex-col items-center gap-2">
                     <button 
                        onClick={() => setIsDetached(!isDetached)}
                        className={`px-6 py-3 rounded-full font-bold transition-all ${isDetached ? 'bg-slate-800 text-white' : 'bg-yellow-500 text-black hover:bg-yellow-400 shadow-lg shadow-yellow-500/20'}`}
                    >
                        {isDetached ? "↺ REATTACH" : "UNWRAP RIM ➔"}
                    </button>
                </div>

                {/* DETACHED RIM */}
                <div className="w-64 h-64 flex flex-col items-center justify-center border-2 border-dashed border-slate-800 rounded-xl bg-slate-900/50 relative">
                    {isDetached ? (
                        renderRimSquare()
                    ) : (
                        <div className="text-slate-600 text-xs text-center p-4">
                            Click "Unwrap" to see the Rim form a square.
                        </div>
                    )}
                </div>

            </div>

            {/* FORMULA BAR */}
            <div className="mt-12 bg-slate-900 p-6 rounded-xl border border-slate-800 w-full max-w-2xl">
                <div className="flex justify-around items-center text-center">
                    
                    <div>
                        <div className="text-blue-500 font-bold text-2xl mb-1">{current.inner}²</div>
                        <div className="text-[10px] text-slate-500 uppercase">Inner Square</div>
                        <div className="text-sm text-slate-400 font-mono">{current.inner * current.inner}</div>
                    </div>
                    
                    <div className="text-slate-600 text-2xl">+</div>

                    <div>
                        <div className="text-yellow-500 font-bold text-2xl mb-1">{current.k}²</div>
                        <div className="text-[10px] text-slate-500 uppercase">The Rim</div>
                        <div className="text-sm text-slate-400 font-mono">{current.rim}</div>
                    </div>

                    <div className="text-white text-2xl">=</div>

                    <div>
                        <div className="text-white font-bold text-2xl mb-1">{current.outer}²</div>
                        <div className="text-[10px] text-slate-500 uppercase">Total Grid</div>
                        <div className="text-sm text-slate-400 font-mono">{current.outer * current.outer}</div>
                    </div>

                </div>
                
                <div className="text-center mt-6 pt-4 border-t border-slate-800">
                    <div className="text-xs text-slate-500 mb-2">Select Example Layer:</div>
                    <div className="flex justify-center gap-2">
                        {triples.map((t, i) => (
                            <button 
                                key={t.layer}
                                onClick={() => { setIndex(i); setIsDetached(false); }}
                                className={`px-4 py-1 rounded text-xs font-bold border ${index === i ? 'bg-slate-700 border-slate-500 text-white' : 'bg-slate-900 border-slate-800 text-slate-500 hover:bg-slate-800'}`}
                            >
                                Layer {t.layer}
                            </button>
                        ))}
                    </div>
                </div>
            </div>

        </div>
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);

</script>
</body>
</html>

