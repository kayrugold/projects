<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Growth Ring Position Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { background-color: #0f172a; color: white; font-family: monospace; }
        .cell { transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .pulse-line { animation: pulseBorder 2s infinite; }
        @keyframes pulseBorder { 0% { border-color: rgba(59, 130, 246, 0.5); } 50% { border-color: rgba(59, 130, 246, 1); box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); } 100% { border-color: rgba(59, 130, 246, 0.5); } }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">

const App = () => {
    const [baseSize, setBaseSize] = React.useState(3);
    const [viewMode, setViewMode] = React.useState('between'); // 'between', 'front', 'on'

    // Calculate geometry
    const oldSquareArea = baseSize * baseSize;
    const newSquareArea = (baseSize + 1) * (baseSize + 1);
    const oddNumber = newSquareArea - oldSquareArea; // The Gnomon
    const isPrime = (num) => {
        for(let i = 2, s = Math.sqrt(num); i <= s; i++) if(num % i === 0) return false; 
        return num > 1;
    }
    const oddIsPrime = isPrime(oddNumber);

    const renderGrid = () => {
        let cells = [];
        // We render the "New Square" size (baseSize + 1)
        const gridSize = baseSize + 1;

        for (let y = 0; y < gridSize; y++) {
            for (let x = 0; x < gridSize; x++) {
                const isOldSquare = x < baseSize && y < baseSize;
                const isGrowthLayer = !isOldSquare;
                const isCorner = x === baseSize && y === baseSize;
                const isOnDiagonal = x === y;

                // Determine Styling based on View Mode
                let bg = "bg-slate-800";
                let border = "border-slate-900";
                let opacity = "opacity-100";
                let transform = "scale(1)";
                let zIndex = "z-0";

                if (isOldSquare) {
                    bg = "bg-slate-700";
                    if (viewMode === 'front') opacity = "opacity-30"; // Dim old to show growth "in front"
                }

                if (isGrowthLayer) {
                    bg = oddIsPrime ? "bg-blue-500" : "bg-orange-500";
                    border = "border-white/10";
                    zIndex = "z-10";
                    
                    if (viewMode === 'between') {
                        // Highlight the sandwich nature
                        if (isCorner) bg = "bg-white text-black"; // The pivot
                    }
                    
                    if (viewMode === 'on' && isOnDiagonal) {
                        // Highlight only the diagonal axis
                         bg = "bg-purple-500 shadow-[0_0_15px_rgba(168,85,247,0.8)]";
                         transform = "scale(1.1)";
                         zIndex = "z-20";
                    }
                }

                cells.push(
                    <div 
                        key={`${x}-${y}`}
                        className={`cell relative border ${border} ${bg} ${opacity} ${zIndex} flex items-center justify-center`}
                        style={{ transform }}
                    >
                        {/* Render coordinate or logical indicators based on mode */}
                        {viewMode === 'on' && isOnDiagonal && isGrowthLayer && <div className="w-2 h-2 bg-white rounded-full animate-ping absolute"></div>}
                    </div>
                );
            }
        }
        return cells;
    };

    return (
        <div className="min-h-screen flex flex-col items-center justify-center p-4">
            
            <div className="mb-8 text-center">
                <h1 className="text-2xl font-bold mb-2">POSITION <span className="text-blue-400">ANALYZER</span></h1>
                <p className="text-xs text-slate-400 max-w-md mx-auto">
                    Is the odd number "Behind", "In Front", or "On" the line?
                </p>
            </div>

            <div className="flex flex-col md:flex-row items-center gap-12">
                
                {/* Graphic */}
                <div className="relative">
                    {/* The "Previous Line" (Boundary of Old Square) */}
                    <div 
                        className="absolute top-0 left-0 border-r-2 border-b-2 border-slate-400 z-20 pointer-events-none"
                        style={{
                            width: `calc(${(baseSize / (baseSize + 1)) * 100}% - 2px)`,
                            height: `calc(${(baseSize / (baseSize + 1)) * 100}% - 2px)`
                        }}
                    >
                        <div className="absolute -right-3 -bottom-3 text-[10px] bg-slate-900 text-slate-400 px-1">Line A</div>
                    </div>

                    {/* The "New Line" (Boundary of New Square) */}
                    <div className="absolute inset-0 border-2 border-blue-500 z-20 pointer-events-none pulse-line">
                         <div className="absolute -right-3 -bottom-6 text-[10px] bg-slate-900 text-blue-400 px-1 font-bold">Line B</div>
                    </div>

                    <div 
                        className="grid gap-1"
                        style={{
                            gridTemplateColumns: `repeat(${baseSize + 1}, 1fr)`,
                            width: '300px',
                            height: '300px'
                        }}
                    >
                        {renderGrid()}
                    </div>
                </div>

                {/* Controls & Explanation */}
                <div className="w-full max-w-xs space-y-6">
                    
                    <div className="space-y-2">
                        <button 
                            onClick={() => setViewMode('between')}
                            className={`w-full p-3 text-left rounded border-l-4 transition-all ${viewMode === 'between' ? 'bg-slate-800 border-blue-500' : 'border-transparent hover:bg-slate-800/50'}`}
                        >
                            <div className="font-bold text-sm">1. Between the Lines</div>
                            <div className="text-[10px] text-slate-400">The odd number is the "filling" between Line A and Line B.</div>
                        </button>

                        <button 
                            onClick={() => setViewMode('front')}
                            className={`w-full p-3 text-left rounded border-l-4 transition-all ${viewMode === 'front' ? 'bg-slate-800 border-orange-500' : 'border-transparent hover:bg-slate-800/50'}`}
                        >
                            <div className="font-bold text-sm">2. In Front (Growth)</div>
                            <div className="text-[10px] text-slate-400">The odd number sits "in front" of the old square, pushing outward.</div>
                        </button>

                        <button 
                            onClick={() => setViewMode('on')}
                            className={`w-full p-3 text-left rounded border-l-4 transition-all ${viewMode === 'on' ? 'bg-slate-800 border-purple-500' : 'border-transparent hover:bg-slate-800/50'}`}
                        >
                            <div className="font-bold text-sm">3. On The Axis</div>
                            <div className="text-[10px] text-slate-400">The middle block of the odd number sits exactly ON the diagonal line.</div>
                        </button>
                    </div>

                    <div className="pt-4 border-t border-slate-700">
                        <label className="text-xs font-bold text-slate-500 mb-2 block">SQUARE SIZE</label>
                        <input 
                            type="range" min="1" max="6" value={baseSize} 
                            onChange={(e) => setBaseSize(parseInt(e.target.value))}
                            className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"
                        />
                        <div className="text-right text-xs font-mono mt-1 text-blue-400">
                            Adding Layer {baseSize + 1}: <span className="text-white text-lg">{oddNumber} blocks</span>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);

</script>
</body>
</html>

