<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4-Quadrant Prime Visualizer</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { background-color: #020617; color: #e2e8f0; font-family: 'Courier New', Courier, monospace; overflow: hidden; }
        .cell-anim { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
        
        /* Custom Scrollbar for the grid container if needed */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        
        #root:empty::before { content: "Initializing System..."; color: #64748b; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
    </style>
</head>
<body>

<div id="root"></div>

<script type="text/babel">

const App = () => {
    const [layerCount, setLayerCount] = React.useState(1);
    const [quadrantMode, setQuadrantMode] = React.useState(false);
    const [isPlaying, setIsPlaying] = React.useState(false);
    
    // --- Math Core ---
    const isPrime = (num) => {
        if (num <= 1) return false;
        if (num <= 3) return true;
        if (num % 2 === 0 || num % 3 === 0) return false;
        for (let i = 5; i * i <= num; i += 6) {
            if (num % i === 0 || num % (i + 2) === 0) return false;
        }
        return true;
    };

    // Pre-calculate layer data
    const layersData = React.useMemo(() => {
        const data = [];
        for (let i = 1; i <= 30; i++) { // Calculate up to max reasonable size
            const blocks = (2 * i) - 1; 
            data.push({
                index: i,
                blocks: blocks,
                isPrime: isPrime(blocks),
                area: i * i
            });
        }
        return data;
    }, []);

    // --- Animation Loop ---
    React.useEffect(() => {
        let interval;
        if (isPlaying) {
            interval = setInterval(() => {
                setLayerCount(prev => {
                    if (prev >= 15) { // Cap at 15 for visual sanity in quad mode
                        setIsPlaying(false);
                        return prev;
                    }
                    return prev + 1;
                });
            }, 300);
        }
        return () => clearInterval(interval);
    }, [isPlaying]);

    const currentLayer = layersData[layerCount - 1];

    // --- Grid Rendering Logic ---
    // We render a coordinate system based on "quadrantMode"
    // If Quad Mode: Range is -N to +N
    // If Single Mode: Range is 0 to N
    
    const renderGrid = () => {
        let cells = [];
        
        // Determine Grid Range
        const max = layerCount; // e.g., 5
        const min = quadrantMode ? -max + 1 : 0; // Quad: -4 to +5, Single: 0 to 5
        const totalSize = max - min; // Grid dimension

        for (let y = min; y < max; y++) {
            for (let x = min; x < max; x++) {
                
                // Math Logic to find "Layer" from Coordinates (x,y)
                // In Single Mode: Layer is max(x, y) + 1
                // In Quad Mode: We mirror everything, so we take abs(x) and abs(y)
                // But we need to handle the 0-index offset correctly for the visual
                
                let layerIndex;
                if (quadrantMode) {
                    // For quad mode, 0,0 is the center (layer 1)
                    // -1,0 is layer 2, etc.
                    // distance logic: Max Chebychev distance from origin
                    const dist = Math.max(Math.abs(x >= 0 ? x : x + 1), Math.abs(y >= 0 ? y : y + 1));
                    layerIndex = dist + 1;
                } else {
                    layerIndex = Math.max(x, y) + 1;
                }

                // Safety check
                if (layerIndex > layerCount) continue; // Should not happen with correct loop bounds but good for safety

                const layerInfo = layersData[layerIndex - 1];
                const isOuter = layerIndex === layerCount;
                
                // Styling
                const isCenter = quadrantMode && (x === 0 || x === -1) && (y === 0 || y === -1);
                
                let bgColor, borderColor;
                
                if (layerInfo.isPrime) {
                    // PRIME LAYER
                    bgColor = isOuter ? "bg-cyan-500 shadow-[0_0_15px_rgba(6,182,212,0.6)]" : "bg-cyan-900/30";
                    borderColor = isOuter ? "border-cyan-300" : "border-cyan-900/50";
                } else {
                    // COMPOSITE LAYER
                    bgColor = isOuter ? "bg-rose-600" : "bg-slate-800";
                    borderColor = isOuter ? "border-rose-400" : "border-slate-800";
                }

                // Highlight axes in Quad mode
                if (quadrantMode && (x === 0 || x === -1) && (y === 0 || y === -1) && layerIndex === 1) {
                   // Center point styling
                   bgColor = "bg-white";
                   borderColor = "border-white";
                }

                cells.push(
                    <div 
                        key={`${x},${y}`}
                        className={`
                            ${bgColor} border ${borderColor}
                            cell-anim relative
                        `}
                        style={{
                            // Slight delay based on distance for ripple effect
                            animationDelay: `${layerIndex * 0.05}s` 
                        }}
                    />
                );
            }
        }
        return cells;
    };

    return (
        <div className="h-screen w-screen flex flex-col bg-slate-950 text-slate-200">
            
            {/* TOP BAR */}
            <div className="flex-none p-4 border-b border-slate-800 bg-slate-900/80 backdrop-blur flex justify-between items-center z-10">
                <div>
                    <h1 className="text-xl font-bold tracking-tight text-cyan-400">QUADRANT <span className="text-white">ARCHITECT</span></h1>
                    <div className="text-[10px] text-slate-500 font-mono uppercase">Visualizing Square Expansion</div>
                </div>
                
                <div className="flex items-center gap-4">
                    <div className="text-right hidden sm:block">
                        <div className="text-2xl font-mono font-bold text-white leading-none">
                            {quadrantMode ? (currentLayer.blocks * 4) : currentLayer.blocks}
                        </div>
                        <div className="text-[9px] text-slate-500 uppercase tracking-wider">Blocks in Outer Rim</div>
                    </div>
                    <div className="h-8 w-[1px] bg-slate-700 mx-2"></div>
                     <div className="text-right hidden sm:block">
                        <div className="text-2xl font-mono font-bold text-white leading-none">
                            {quadrantMode ? ((layerCount * 2) * (layerCount * 2)) : (layerCount * layerCount)}
                        </div>
                        <div className="text-[9px] text-slate-500 uppercase tracking-wider">Total Area</div>
                    </div>
                </div>
            </div>

            {/* MAIN VIEWPORT */}
            <div className="flex-1 relative flex items-center justify-center overflow-hidden p-4 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-slate-900 to-slate-950">
                
                {/* Grid Container */}
                <div 
                    className="grid gap-[1px] transition-all duration-500 ease-in-out"
                    style={{
                        // Dynamic Grid Sizing
                        gridTemplateColumns: `repeat(${quadrantMode ? layerCount * 2 : layerCount}, minmax(0, 1fr))`,
                        width: 'min(90vmin, 600px)',
                        aspectRatio: '1/1'
                    }}
                >
                    {renderGrid()}
                </div>

                {/* Axis Lines (Visual Aid for Quad Mode) */}
                {quadrantMode && (
                    <div className="absolute inset-0 pointer-events-none flex items-center justify-center">
                        <div className="w-full h-[1px] bg-white/10"></div>
                        <div className="h-full w-[1px] bg-white/10 absolute"></div>
                    </div>
                )}
            </div>

            {/* BOTTOM CONTROLS */}
            <div className="flex-none p-6 border-t border-slate-800 bg-slate-900 z-10">
                <div className="max-w-2xl mx-auto flex flex-col gap-4">
                    
                    {/* Mode Toggle */}
                    <div className="flex bg-slate-800 p-1 rounded-lg self-center">
                        <button 
                            onClick={() => { setQuadrantMode(false); setLayerCount(1); setIsPlaying(false); }}
                            className={`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${!quadrantMode ? 'bg-cyan-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}
                        >
                            Single Origin
                        </button>
                        <button 
                            onClick={() => { setQuadrantMode(true); setLayerCount(1); setIsPlaying(false); }}
                            className={`px-6 py-2 rounded-md text-xs font-bold uppercase tracking-wider transition-all ${quadrantMode ? 'bg-purple-600 text-white shadow-lg' : 'text-slate-400 hover:text-white'}`}
                        >
                            4 Quadrants
                        </button>
                    </div>

                    {/* Action Buttons */}
                    <div className="flex gap-3 h-12">
                        <button 
                            onClick={() => setLayerCount(c => c + 1)}
                            className="flex-1 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded font-bold transition-colors border-b-4 border-slate-900 active:border-b-0 active:translate-y-1"
                        >
                            + GROW
                        </button>
                        <button 
                            onClick={() => setIsPlaying(!isPlaying)}
                            className={`flex-1 rounded font-bold transition-colors border-b-4 active:border-b-0 active:translate-y-1 ${isPlaying ? 'bg-rose-600 border-rose-800 text-white' : 'bg-slate-700 border-slate-900 text-slate-300 hover:bg-slate-600'}`}
                        >
                            {isPlaying ? 'STOP' : 'AUTO EXPAND'}
                        </button>
                        <button 
                            onClick={() => {setLayerCount(1); setIsPlaying(false);}}
                            className="px-6 bg-slate-800 hover:bg-slate-700 text-slate-400 rounded border-b-4 border-slate-950 active:border-b-0 active:translate-y-1 font-bold"
                        >
                            RESET
                        </button>
                    </div>
                </div>
            </div>

        </div>
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);

</script>
</body>
</html>

