<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Andy's Dev Studio</title>
    <meta name="theme-color" content="#1a120b">
    <link rel="manifest" href="manifest.json">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Cormorant+Garamond:wght@400;600&family=Share+Tech+Mono&family=Homemade+Apple&display=swap" rel="stylesheet">

    <script src="config.js"></script>
    <link rel="stylesheet" href="style.css?v=2.0.7">
</head>
<body>

    <div id="updateOverlay" class="update-overlay" style="display:none;">
        <div class="update-card">
            <h2 style="font-family:'Cinzel', serif; margin-top:0;">SYSTEM UPDATE</h2>
            <div class="progress-container">
                <div id="updateProgress" class="update-progress-fill"></div>
            </div>
            <p id="updateStatus">Downloading New Assets...</p>
            <p style="font-size:0.7rem; color:var(--gold);">[ v<span id="ui-version-display">---</span> ]</p>
        </div>
    </div>

    <div id="appLayer" class="app-layer">
        <iframe id="appFrame" src="" allow="fullscreen"></iframe>
        <div class="app-vignette"></div>
    </div>

    <div id="journalReader" class="journal-reader">
        <button class="journal-close-btn" onclick="closeJournal()">X CLOSE</button>
        <div id="journalContent" class="journal-content"></div>
    </div>

    <div id="infoModal" class="modal-overlay">
        <div class="info-card">
            <h2 style="font-family:'Cinzel', serif; margin-top:0;">Andy's Dev Studio</h2>
            <p style="font-size:0.9rem; margin-bottom:5px;"><strong>Version:</strong> <span id="modal-version-display">---</span></p>
            <p style="font-size:0.9rem; margin-bottom:5px;"><strong>System:</strong> Online</p>
            <p style="font-size:0.9rem; font-style:italic;">"Forged in code, tested on the road."</p>
            <hr style="border:0; border-top:1px dashed #aaa; margin:15px 0;">
            <button onclick="goHome()" class="info-btn btn-home">Return to Home</button>
            <button onclick="toggleInfo()" class="info-btn">Close</button>
        </div>
    </div>

    <a href="https://discord.gg/WHhnBXpDSW" target="_blank" class="palantir-btn" title="Open Comm Link">
        <div class="palantir-icon"></div>
    </a>
        
    <div class="status-bar">
        <img src="./assets/icon.webp" alt="Studio Logo" class="status-logo" onclick="toggleInfo()" width="32" height="32">
        <a href="https://www.buymeacoffee.com/kayrugold" target="_blank" class="icon-btn" style="border-color:var(--gold); color:var(--gold); margin-right:15px; text-decoration:none;"><img src="./assets/coffee.webp" alt="Coffee" width="32" height="32"></a>
        <div class="os-clock" id="clock">12:00</div>
        <button class="icon-btn" id="soundBtn" onclick="toggleSound()"><img id="soundIcon" src="./assets/soundoff.webp" alt="sound" width="32" height="32"></button>
        <button class="icon-btn" onclick="toggleFullscreen()"><img src="./assets/fullscreen.webp" width="32" height="32"></button>
    </div>

    <div id="library-view">
        <div class="desk-layout">
            <div class="desk-left">
                <div class="desk-note">
                    <div class="note-header">Andy's Dev Studio</div>
                    <div class="note-hand">
                        Welcome to the forge. <br><br>
                        Systems are stable. I am currently working on the physics engine for the new dice roller. <br><br>
                        Check the Market for the new Asset Pack.
                    </div>
                </div>
                <div class="paper-scrap">
                    <div class="scrap-title">LATEST UPDATE: ---</div>
                    <div class="scrap-text">
                        The archives are now open. Procedural audio engine enabled.
                    </div>
                </div>
            </div>

            <div class="desk-right">
                <div class="shelf">
                    <div class="book-spine spine-forge" onclick="openBook('forge')">
                        <div class="spine-title">The Forge</div>
                        <div class="spine-subtitle">Projects & Prototypes</div>
                    </div>
                    <div class="book-spine spine-market" onclick="openBook('market')">
                        <div class="spine-title">The Ledger</div>
                        <div class="spine-subtitle">Market & Trade Goods</div>
                    </div>
                    <div class="book-spine spine-chronicles" onclick="openBook('chronicles')">
                        <div class="spine-title">The Chronicles</div>
                        <div class="spine-subtitle">Developer Logs</div>
                    </div>
                    <div class="book-spine spine-guild" onclick="openBook('guild')">
                        <div class="spine-title">Guild Records</div>
                        <div class="spine-subtitle">Contact & Testing</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="book-view">
        <div class="page-content" id="page-content"></div>
    </div>

    <div class="bookmark-container" id="bookmarks" style="display:none;">
        <div class="bookmark bm-home" onclick="closeBook()"><div class="bookmark-icon"><img src="./assets/icon_home.webp" alt="Home"></div></div>
        <div class="bookmark bm-forge" onclick="switchPage('forge')"><div class="bookmark-icon"><img src="./assets/icon_forge.webp" alt="Forge"></div></div>
        <div class="bookmark bm-market" onclick="switchPage('market')"><div class="bookmark-icon"><img src="./assets/icon_market.webp" alt="Market"></div></div>
        <div class="bookmark bm-chronicles" onclick="switchPage('chronicles')"><div class="bookmark-icon"><img src="./assets/icon_chronicles.webp" alt="Chronicles"></div></div>
        <div class="bookmark bm-guild" onclick="switchPage('guild')"><div class="bookmark-icon"><img src="./assets/icon_guild.webp" alt="Guild"></div></div>
        <div class="bookmark bm-ravens" onclick="switchPage('ravens')"><div class="bookmark-icon"><img src="./assets/icon_raven.webp" alt="Rookery"></div></div>
    </div>

    <script src="app.js"></script>
    <script src="embers.js"></script>

    <script>
        // Master UI Sync - Updates all version labels on page load
        document.addEventListener('DOMContentLoaded', () => {
            // Update the Info Modal
            const modalVer = document.getElementById('modal-version-display');
            if (modalVer) modalVer.innerText = FORGE_VERSION;

            // Update the Paper Scrap text (Optional)
            const scrapVer = document.querySelector('.scrap-title');
            if (scrapVer) scrapVer.innerText = `LATEST UPDATE: v${FORGE_VERSION}`;
        });
    </script>
</body>
</html>
